<!doctype html>
<meta charset="utf-8">
<script>
Number.prototype.forEach = function (a) { var i = 0; while (i < this) a(i++) }

var
log = console.log.bind(console),
id = function (a) {
  var _ = new Uint32Array(a)
  crypto.getRandomValues(_)
  return Array.prototype.map.call(_, function (a) {
    a = a.toString(16)
    return ['00000000'.slice(a.length), a].join('')
  }).join('')
},
db,
req = indexedDB.open('db'),
put = function (k, v, next) {
  var req = db.transaction('store', 'readwrite').objectStore('store').put(v, k)

  req.onsuccess = function () { next(null, this.result) }
  req.onerror = function () { next(this.error) }
},
get = function (k, next) {
  var req = db.transaction('store').objectStore('store').get(k)

  req.onsuccess = function () { next(null, this.result) }
  req.onerror = function () { next(this.error) }
},
del = function (k, next) {
  var req = db.transaction('store', 'readwrite').objectStore('store').delete(k)

  req.onsuccess = function () { next(null, this.result) }
  req.onerror = function () { next(this.error) }
}

req.onupgradeneeded = function () {
  db = this.result
  db.createObjectStore('store')
}
req.onsuccess = function () {
  db = this.result
}
req.onerror = function () {
  console.error(this.error)
}
</script>
